# 웹 성능 최적화

## Critical Rendering Path(중요 렌더링 경로)에 대해 설명해주세요.

**Critical Rendering Path**는 **브라우저에서 웹 사이트를 띄우기까지의 경로**를 말합니다. 즉 브라우저에서 HTML, CSS, JS를 읽고 웹 사이트가 유저의 이벤트에 반응하기까지의 일련의 과정을 말하며, Critical Rendering Path는 DOM, CSSOM, 렌더트리, 레이아웃을 포함합니다.

Critical Rendering Path를 최적화하는 것은 **렌더링 시간**을 개선시킵니다. 사용자의 상호작용과 버벅거림, 리플로우 리페인트를 개선시킬 수 있습니다.

방법으로는 자원의 로드 순서를 최적화하는 것, 파일 사이즈를 줄이는 것 등이 있습니다.

예시로 HTML을 파싱이 일어날 때 중간에 HTML 파싱을 막는 동작, 즉 블록 리소스가 있을 수 있는데요. 블록 리소스는 페인트 과정을 지연시키므로 HTML 파싱을 막는 상황이 발생하지 않도록 해야 하는데, CSS관련 link 태그를 head 태그의 가장 아래에 위치시키거나, JS관련 script 태그를 body 태그의 제일 아래에 위치시키는 방법을 주로 사용합니다.

## Reflow & Repaint

![](https://velog.velcdn.com/images/jiseung/post/0fdd6126-c175-4963-963d-1a1020e949fc/image.png)

Reflow는 레이아웃 단계부터 다시 합성 & 렌더까지 진행하는 과정입니다. 레이아웃 과정에서는 어떤 요소가 어느 위치에 배정되는지, 어떤 요소가 어느 정도의 크기를 가지고 있는지 연산하는 단계이며, 이 단계를 포함하는 Reflow를 발생시키는 경우 비용이 커집니다.

Repaint는 페인트 단계부터 다시 합성 & 렌더까지 진행하는 과정입니다. 화면에서 색상을 바꾸거나 배경을 바꾸는 듯 어떤 요소를 다시 그려줘야할 때 Repaint가 진행되는데 이때는 레이아웃(연산) 단계를 건너띄므로 Reflow에 비해 상대적으로 비용이 적습니다.

### Reflow를 발생시키는 속성

```jsx
position / width / height / margin / padding / display / top / left / right / bottom /
box-sizing / background-color / border-color / text-align / border / border-width /
font-family / float / font-size / font-weight / line-height / vertical-align /
white-space / word-wrap / text-overflow / text-shadow ...
```

### Repaint를 발생시키는 속성

```jsx
color / border-style / visibility / background /
background-image / background-position / background-repeat / background-size /
text-decoration / outline / outline-style / outline-color / outline-width /
border-radius / box-shadow ...
```

## CSS in CSS vs CSS in JS

**CSS in JS**는 자바스크립트 코드 내에서 CSS를 작성하는 방식으로

1. style 파일을 별도로 관리할 필요가 없고,
2. **자바스크립트와 CSS 간의 상수 및 함수를 쉽게 공유**할 수 있습니다.
3. 고유한 클래스 명이 생성되므로 코드를 경량화할 수 있고
4. CSS가 component scope에서만 적용되어 우선순위 문제가 발생하지 않아 컴포넌트 기반의 프레임워크를 사용할 때 용이합니다.

하지만

1. 라이브러리 설치가 필요하기 때문에 번들의 크기가 커지며,
2. 새로운 의존성이 발생하며,
3. CSS in CSS 방식에 비해 CSS 적용이 느립니다.

**CSS in CSS**는 CSS Module, SCSS 등이 pure CSS의 단점을 해결해줄 수 있습니다.

1. 전체 페이지에 필요한 CSS를 처음부터 전부 로딩하여 style 태그를 생성할 수 있고
2. CSS 파일에 선언한 클래스 이름들이 고유해지게 됩니다.

작업자의 성향이나 판단이 필요하거나, 개발 효율성에 중점을 둔 **컴포넌트 위주의 프로젝트**라면 **CSS in JS를 고려**하는 것이 좋습니다. 필요한 컴포넌트 페이지의 CSS 스타일 요소만 로딩하기 때문입니다.

반면 사용자 편의에 방점을 둔 **인터렉티브한 웹 프로젝트**라면 랜더링 시 모든 **CSS 스타일 요소를 로딩하기 때문에 상태에 따라 빠른 적용이 가능한 CSS in CSS 방식을 권장**됩니다.
